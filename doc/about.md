



Теория
======


Отдельно встал вопрос вычисления границ операционного пространства.
Практического применения для решения данного вопроса пока найдено не было.

Суть решения в следующем:

1. Фиксируем высоту - все вычисления будут проводиться для заданной горизонтальной плоскости z = z0.
2. Три сферы с одинаковыми радиусами, равными длине тяг.
3. Положение центра сфер вычисляется как сумма трех векторов: вектор из центра базы к оси рычага (плеча), от оси рычага к оси крепления тяг, и в плоскости эффектора от оси крепления тяг к центру эффектора.
4. На плоскости три окружности - сечения сфер заданной плоскостью.
5. Окружности пересекаются в одной точке - центре эффектора.
6. Переходим в полярные координаты - задаём радиус-вектор положения эффектора.
7. Складываем его по теореме косинусов с радиус-векторами положения центров окружностей - получаем радиусы окружностей.
8. Получаем систему из трех квадратных уравнений относительно радиус-вектора центра эффектора.
9. Они-же уже не система, а просто три квадратных уравнения относительно косинусов углов положения рычагов.
10. Зададим угол радиус-вектора положения эффектора и вычислим все значения его модуля для крайних положений рычагов.
11. Минимальный из полученных радиусов будет максимальным отклонением центра эффектора в данной плоскости и направлении.


Механика
========

Рука сервомашинки (плечо - те деталь которая крепится прямо на вал сервы)
вырезана из поликарбоната толщиной 5мм (по ширине вала) и плотно насаживается
с предварительным нагреванием, например феном.
Люфта в месте крепления нет, но само плечо гнётся при боковых нагрузках.
Возможно, этого можно избежать используя более толстый лист поликарбоната.

Тяга дельты - карбоновая трубка с вклеенными с двух сторон болтами 3мм резбой
наружу. На болты накручиваются шаровые соединения (ball-joint)
повсеместно используемые в авиа и авто-моделировании.
Вроде таких:
http://www.hobbyking.com/hobbyking/store/__13099__m3_alloy_ball_joint_5pcs_bag_.html

Остальные детали печатаются из пластика на 3D принтере.




Контроллер
==========

Изначально использовался Arduino UNO. Но с ним было два непонятных бага. Первый -
всё работало только сразу после перепрошивки. Второй - сервы иногда самопроизвольно дёргались.
Думаю что второй связан с реализацией ШИМ в библиотеке arduino servo.
ШИМ там сделана программно на прерываниях для того чтобы её можно было вывести на любую ногу.

На данный момент используется плата STM32 value line Discovery и её аппаратны ШИМ.
Пока работало стабильно.


Протокол
========

На данный момент (при отсутствии датчиков) протокол настолько простой что не заслуживает даже отдельного описания.
Для прошивки discovery изначально делался интерфейс командной строки на serial порту для отладки руками.
Управляющая программа на python тоже в состоянии отправлять комманды типа "pwm duty 1500 1400 1350\r" в /dev/ttyUSB0.


Управляющая программа на стороне ПК
===================================

Написана на python.
Пока реализовано только управление с помощью мыши и корявые демо-тесты.



